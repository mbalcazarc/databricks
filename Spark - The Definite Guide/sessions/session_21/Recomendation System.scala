{"version":"NotebookV1","origId":2178463341864265,"name":"Recomendation System","language":"scala","commands":[{"version":"CommandV1","origId":613917369745113,"guid":"56209a94-a876-4874-965f-32386e2cb757","subtype":"command","commandType":"auto","position":2.25,"command":"display(ratings.describe())","commandVersion":6,"state":"finished","results":{"type":"table","data":[["count","1501","1501","1501","1501"],["mean","14.383744170552964","49.40572951365756","1.7741505662891406","1.424380312E9"],["stddev","8.591040424293272","28.937034065088994","1.187276166124803","0.0"],["min","0","0","1.0","1424380312"],["max","29","99","5.0","1424380312"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"summary","type":"\"string\"","metadata":"{}"},{"name":"userId","type":"\"string\"","metadata":"{}"},{"name":"movieId","type":"\"string\"","metadata":"{}"},{"name":"rating","type":"\"string\"","metadata":"{}"},{"name":"timestamp","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949480180,"submitTime":1653949436162,"finishTime":1653949486062,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"768","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",5]],"subcommandOptions":null,"nuid":"1c6e1a85-dbf6-4a2b-997b-278720764e94"},{"version":"CommandV1","origId":613917369745116,"guid":"6069de4f-502d-427f-80e2-a614a458e9ee","subtype":"command","commandType":"auto","position":2.375,"command":"import org.apache.spark.sql.functions._\n\ndisplay(\n  ratings\n  .groupBy(\"rating\").count\n  .withColumn(\"percentage\", $\"count\"*100/sum($\"count\").over())\n  .orderBy(\"rating\")\n)","commandVersion":55,"state":"finished","results":{"type":"table","data":[[1.0,941,62.69153897401732],[2.0,207,13.79080612924717],[3.0,179,11.925383077948034],[4.0,99,6.595602931379081],[5.0,75,4.996668887408394]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"rating","type":"\"float\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"},{"name":"percentage","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949486084,"submitTime":1653949436176,"finishTime":1653949489958,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"plotlyBar","width":"660","height":"315","xColumns":["rating"],"yColumns":["percentage"],"pivotColumns":[],"pivotAggregation":"sum","useConsistentColors":false,"customPlotOptions":{"histogram":[{"key":"bins","value":"10"}],"plotlyBar":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"quantilePlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",5]],"subcommandOptions":null,"nuid":"99bf3cf4-6dff-4162-8124-63d7a382c287"},{"version":"CommandV1","origId":613917369745117,"guid":"73ebe8df-d306-4be3-a6e5-627e41769c1d","subtype":"command","commandType":"auto","position":8.25,"command":"val ranks = new RankingMetrics(perUserActualvPred.rdd)","commandVersion":7,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">ranks: org.apache.spark.mllib.evaluation.RankingMetrics[Integer] = org.apache.spark.mllib.evaluation.RankingMetrics@1e73b9f4\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949576367,"submitTime":1653949436451,"finishTime":1653949583834,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",152]],"subcommandOptions":null,"nuid":"433cbcbc-a426-4c0f-aa40-78ed36cc0d5a"},{"version":"CommandV1","origId":2178463341864267,"guid":"3b92f2f9-da27-4720-8380-a6a98a77aac1","subtype":"command","commandType":"auto","position":2.0,"command":"import org.apache.spark.sql.types._\n\nval ratings = spark.read.format(\"csv\")\n  .option(\"delimiter\", \"::\")\n  .load(\"s3://renidev-s3-test/sample_movielens_ratings.txt\")\n  .withColumnRenamed(\"_c0\", \"userId\")\n  .withColumnRenamed(\"_c1\", \"movieId\")\n  .withColumnRenamed(\"_c2\", \"rating\")\n  .withColumnRenamed(\"_c3\", \"timestamp\")\n  .withColumn(\"userId\", $\"userId\".cast(IntegerType))\n  .withColumn(\"movieId\", $\"movieId\".cast(IntegerType))\n  .withColumn(\"rating\", $\"rating\".cast(FloatType))\n  .withColumn(\"timestamp\", $\"timestamp\".cast(LongType))\n\ndisplay(ratings)","commandVersion":68,"state":"finished","results":{"type":"table","data":[[0,2,3.0,1424380312],[0,3,1.0,1424380312],[0,5,2.0,1424380312],[0,9,4.0,1424380312],[0,11,1.0,1424380312],[0,12,2.0,1424380312],[0,15,1.0,1424380312],[0,17,1.0,1424380312],[0,19,1.0,1424380312],[0,21,1.0,1424380312],[0,23,1.0,1424380312],[0,26,3.0,1424380312],[0,27,1.0,1424380312],[0,28,1.0,1424380312],[0,29,1.0,1424380312],[0,30,1.0,1424380312],[0,31,1.0,1424380312],[0,34,1.0,1424380312],[0,37,1.0,1424380312],[0,41,2.0,1424380312],[0,44,1.0,1424380312],[0,45,2.0,1424380312],[0,46,1.0,1424380312],[0,47,1.0,1424380312],[0,48,1.0,1424380312],[0,50,1.0,1424380312],[0,51,1.0,1424380312],[0,54,1.0,1424380312],[0,55,1.0,1424380312],[0,59,2.0,1424380312],[0,61,2.0,1424380312],[0,64,1.0,1424380312],[0,67,1.0,1424380312],[0,68,1.0,1424380312],[0,69,1.0,1424380312],[0,71,1.0,1424380312],[0,72,1.0,1424380312],[0,77,2.0,1424380312],[0,79,1.0,1424380312],[0,83,1.0,1424380312],[0,87,1.0,1424380312],[0,89,2.0,1424380312],[0,91,3.0,1424380312],[0,92,4.0,1424380312],[0,94,1.0,1424380312],[0,95,2.0,1424380312],[0,96,1.0,1424380312],[0,98,1.0,1424380312],[0,99,1.0,1424380312],[1,2,2.0,1424380312],[1,3,1.0,1424380312],[1,4,2.0,1424380312],[1,6,1.0,1424380312],[1,9,3.0,1424380312],[1,12,1.0,1424380312],[1,13,1.0,1424380312],[1,14,1.0,1424380312],[1,16,1.0,1424380312],[1,19,1.0,1424380312],[1,21,3.0,1424380312],[1,27,1.0,1424380312],[1,28,3.0,1424380312],[1,33,1.0,1424380312],[1,36,2.0,1424380312],[1,37,1.0,1424380312],[1,40,1.0,1424380312],[1,41,2.0,1424380312],[1,43,1.0,1424380312],[1,44,1.0,1424380312],[1,47,1.0,1424380312],[1,50,1.0,1424380312],[1,54,1.0,1424380312],[1,56,2.0,1424380312],[1,57,1.0,1424380312],[1,58,1.0,1424380312],[1,60,1.0,1424380312],[1,62,4.0,1424380312],[1,63,1.0,1424380312],[1,67,1.0,1424380312],[1,68,4.0,1424380312],[1,70,2.0,1424380312],[1,72,1.0,1424380312],[1,73,1.0,1424380312],[1,74,2.0,1424380312],[1,76,1.0,1424380312],[1,77,3.0,1424380312],[1,78,1.0,1424380312],[1,81,1.0,1424380312],[1,82,1.0,1424380312],[1,85,3.0,1424380312],[1,86,2.0,1424380312],[1,88,2.0,1424380312],[1,91,1.0,1424380312],[1,92,2.0,1424380312],[1,93,1.0,1424380312],[1,94,2.0,1424380312],[1,96,1.0,1424380312],[1,97,1.0,1424380312],[2,4,3.0,1424380312],[2,6,1.0,1424380312],[2,8,5.0,1424380312],[2,9,1.0,1424380312],[2,10,1.0,1424380312],[2,12,3.0,1424380312],[2,13,1.0,1424380312],[2,15,2.0,1424380312],[2,18,2.0,1424380312],[2,19,4.0,1424380312],[2,22,1.0,1424380312],[2,26,1.0,1424380312],[2,28,1.0,1424380312],[2,34,4.0,1424380312],[2,35,1.0,1424380312],[2,37,5.0,1424380312],[2,38,1.0,1424380312],[2,39,5.0,1424380312],[2,40,4.0,1424380312],[2,47,1.0,1424380312],[2,50,1.0,1424380312],[2,52,2.0,1424380312],[2,54,1.0,1424380312],[2,55,1.0,1424380312],[2,57,2.0,1424380312],[2,58,2.0,1424380312],[2,59,1.0,1424380312],[2,61,1.0,1424380312],[2,62,1.0,1424380312],[2,64,1.0,1424380312],[2,65,1.0,1424380312],[2,66,3.0,1424380312],[2,68,1.0,1424380312],[2,71,3.0,1424380312],[2,76,1.0,1424380312],[2,77,1.0,1424380312],[2,78,1.0,1424380312],[2,80,1.0,1424380312],[2,83,5.0,1424380312],[2,85,1.0,1424380312],[2,87,2.0,1424380312],[2,88,1.0,1424380312],[2,89,4.0,1424380312],[2,90,1.0,1424380312],[2,92,4.0,1424380312],[2,93,5.0,1424380312],[3,0,1.0,1424380312],[3,1,1.0,1424380312],[3,2,1.0,1424380312],[3,7,3.0,1424380312],[3,8,3.0,1424380312],[3,9,1.0,1424380312],[3,14,1.0,1424380312],[3,15,1.0,1424380312],[3,16,1.0,1424380312],[3,18,4.0,1424380312],[3,19,1.0,1424380312],[3,24,3.0,1424380312],[3,26,1.0,1424380312],[3,29,3.0,1424380312],[3,33,1.0,1424380312],[3,34,3.0,1424380312],[3,35,1.0,1424380312],[3,36,3.0,1424380312],[3,37,1.0,1424380312],[3,38,2.0,1424380312],[3,43,1.0,1424380312],[3,44,1.0,1424380312],[3,46,1.0,1424380312],[3,47,1.0,1424380312],[3,51,5.0,1424380312],[3,52,3.0,1424380312],[3,56,1.0,1424380312],[3,58,1.0,1424380312],[3,60,3.0,1424380312],[3,62,1.0,1424380312],[3,65,2.0,1424380312],[3,66,1.0,1424380312],[3,67,1.0,1424380312],[3,68,2.0,1424380312],[3,70,1.0,1424380312],[3,72,2.0,1424380312],[3,76,3.0,1424380312],[3,79,3.0,1424380312],[3,80,4.0,1424380312],[3,81,1.0,1424380312],[3,83,1.0,1424380312],[3,84,1.0,1424380312],[3,86,1.0,1424380312],[3,87,2.0,1424380312],[3,88,4.0,1424380312],[3,89,1.0,1424380312],[3,91,1.0,1424380312],[3,94,3.0,1424380312],[4,1,1.0,1424380312],[4,6,1.0,1424380312],[4,8,1.0,1424380312],[4,9,1.0,1424380312],[4,10,1.0,1424380312],[4,11,1.0,1424380312],[4,12,1.0,1424380312],[4,13,1.0,1424380312],[4,14,2.0,1424380312],[4,15,1.0,1424380312],[4,17,1.0,1424380312],[4,20,1.0,1424380312],[4,22,1.0,1424380312],[4,23,1.0,1424380312],[4,24,1.0,1424380312],[4,29,4.0,1424380312],[4,30,1.0,1424380312],[4,31,1.0,1424380312],[4,34,1.0,1424380312],[4,35,1.0,1424380312],[4,36,1.0,1424380312],[4,39,2.0,1424380312],[4,40,3.0,1424380312],[4,41,4.0,1424380312],[4,43,2.0,1424380312],[4,44,1.0,1424380312],[4,45,1.0,1424380312],[4,46,1.0,1424380312],[4,47,1.0,1424380312],[4,49,2.0,1424380312],[4,50,1.0,1424380312],[4,51,1.0,1424380312],[4,52,4.0,1424380312],[4,54,1.0,1424380312],[4,55,1.0,1424380312],[4,60,3.0,1424380312],[4,61,1.0,1424380312],[4,62,4.0,1424380312],[4,63,3.0,1424380312],[4,65,1.0,1424380312],[4,67,2.0,1424380312],[4,69,1.0,1424380312],[4,70,4.0,1424380312],[4,71,1.0,1424380312],[4,73,1.0,1424380312],[4,78,1.0,1424380312],[4,84,1.0,1424380312],[4,85,1.0,1424380312],[4,87,3.0,1424380312],[4,88,3.0,1424380312],[4,89,2.0,1424380312],[4,96,1.0,1424380312],[4,97,1.0,1424380312],[4,98,1.0,1424380312],[4,99,1.0,1424380312],[5,0,1.0,1424380312],[5,1,1.0,1424380312],[5,4,1.0,1424380312],[5,5,1.0,1424380312],[5,8,1.0,1424380312],[5,9,3.0,1424380312],[5,10,2.0,1424380312],[5,13,3.0,1424380312],[5,15,1.0,1424380312],[5,19,1.0,1424380312],[5,20,3.0,1424380312],[5,21,2.0,1424380312],[5,23,3.0,1424380312],[5,27,1.0,1424380312],[5,28,1.0,1424380312],[5,29,1.0,1424380312],[5,31,1.0,1424380312],[5,36,3.0,1424380312],[5,38,2.0,1424380312],[5,39,1.0,1424380312],[5,42,1.0,1424380312],[5,48,3.0,1424380312],[5,49,4.0,1424380312],[5,50,3.0,1424380312],[5,51,1.0,1424380312],[5,52,1.0,1424380312],[5,54,1.0,1424380312],[5,55,5.0,1424380312],[5,56,3.0,1424380312],[5,58,1.0,1424380312],[5,60,1.0,1424380312],[5,61,1.0,1424380312],[5,64,3.0,1424380312],[5,65,2.0,1424380312],[5,68,4.0,1424380312],[5,70,1.0,1424380312],[5,71,1.0,1424380312],[5,72,1.0,1424380312],[5,74,1.0,1424380312],[5,79,1.0,1424380312],[5,81,2.0,1424380312],[5,84,1.0,1424380312],[5,85,1.0,1424380312],[5,86,1.0,1424380312],[5,88,1.0,1424380312],[5,90,4.0,1424380312],[5,91,2.0,1424380312],[5,95,2.0,1424380312],[5,99,1.0,1424380312],[6,0,1.0,1424380312],[6,1,1.0,1424380312],[6,2,3.0,1424380312],[6,5,1.0,1424380312],[6,6,1.0,1424380312],[6,9,1.0,1424380312],[6,10,1.0,1424380312],[6,15,2.0,1424380312],[6,16,2.0,1424380312],[6,17,1.0,1424380312],[6,18,1.0,1424380312],[6,20,1.0,1424380312],[6,21,1.0,1424380312],[6,22,1.0,1424380312],[6,24,1.0,1424380312],[6,25,5.0,1424380312],[6,26,1.0,1424380312],[6,28,1.0,1424380312],[6,30,1.0,1424380312],[6,33,1.0,1424380312],[6,38,1.0,1424380312],[6,39,1.0,1424380312],[6,43,4.0,1424380312],[6,44,1.0,1424380312],[6,45,1.0,1424380312],[6,48,1.0,1424380312],[6,49,1.0,1424380312],[6,50,1.0,1424380312],[6,53,1.0,1424380312],[6,54,1.0,1424380312],[6,55,1.0,1424380312],[6,56,1.0,1424380312],[6,58,4.0,1424380312],[6,59,1.0,1424380312],[6,60,1.0,1424380312],[6,61,3.0,1424380312],[6,63,3.0,1424380312],[6,66,1.0,1424380312],[6,67,3.0,1424380312],[6,68,1.0,1424380312],[6,69,1.0,1424380312],[6,71,2.0,1424380312],[6,73,1.0,1424380312],[6,75,1.0,1424380312],[6,77,1.0,1424380312],[6,79,1.0,1424380312],[6,81,1.0,1424380312],[6,84,1.0,1424380312],[6,85,3.0,1424380312],[6,86,1.0,1424380312],[6,87,1.0,1424380312],[6,88,1.0,1424380312],[6,89,1.0,1424380312],[6,91,2.0,1424380312],[6,94,1.0,1424380312],[6,95,2.0,1424380312],[6,96,1.0,1424380312],[7,1,1.0,1424380312],[7,2,2.0,1424380312],[7,3,1.0,1424380312],[7,4,1.0,1424380312],[7,7,1.0,1424380312],[7,10,1.0,1424380312],[7,11,2.0,1424380312],[7,14,2.0,1424380312],[7,15,1.0,1424380312],[7,16,1.0,1424380312],[7,18,1.0,1424380312],[7,21,1.0,1424380312],[7,22,1.0,1424380312],[7,23,1.0,1424380312],[7,25,5.0,1424380312],[7,26,1.0,1424380312],[7,29,4.0,1424380312],[7,30,1.0,1424380312],[7,31,3.0,1424380312],[7,32,1.0,1424380312],[7,33,1.0,1424380312],[7,35,1.0,1424380312],[7,37,2.0,1424380312],[7,39,3.0,1424380312],[7,40,2.0,1424380312],[7,42,2.0,1424380312],[7,44,1.0,1424380312],[7,45,2.0,1424380312],[7,47,4.0,1424380312],[7,48,1.0,1424380312],[7,49,1.0,1424380312],[7,53,1.0,1424380312],[7,54,1.0,1424380312],[7,55,1.0,1424380312],[7,56,1.0,1424380312],[7,59,1.0,1424380312],[7,61,2.0,1424380312],[7,62,3.0,1424380312],[7,63,2.0,1424380312],[7,66,1.0,1424380312],[7,67,3.0,1424380312],[7,74,1.0,1424380312],[7,75,1.0,1424380312],[7,76,3.0,1424380312],[7,77,1.0,1424380312],[7,81,1.0,1424380312],[7,82,1.0,1424380312],[7,84,2.0,1424380312],[7,85,4.0,1424380312],[7,86,1.0,1424380312],[7,92,2.0,1424380312],[7,96,1.0,1424380312],[7,97,1.0,1424380312],[7,98,1.0,1424380312],[8,0,1.0,1424380312],[8,2,4.0,1424380312],[8,3,2.0,1424380312],[8,4,2.0,1424380312],[8,5,1.0,1424380312],[8,7,1.0,1424380312],[8,9,1.0,1424380312],[8,11,1.0,1424380312],[8,15,1.0,1424380312],[8,18,1.0,1424380312],[8,19,1.0,1424380312],[8,21,1.0,1424380312],[8,29,5.0,1424380312],[8,31,3.0,1424380312],[8,33,1.0,1424380312],[8,35,1.0,1424380312],[8,36,1.0,1424380312],[8,40,2.0,1424380312],[8,44,1.0,1424380312],[8,45,1.0,1424380312],[8,50,1.0,1424380312],[8,51,1.0,1424380312],[8,52,5.0,1424380312],[8,53,5.0,1424380312],[8,54,1.0,1424380312],[8,55,1.0,1424380312],[8,56,1.0,1424380312],[8,58,4.0,1424380312],[8,60,3.0,1424380312],[8,62,4.0,1424380312],[8,64,1.0,1424380312],[8,67,3.0,1424380312],[8,69,1.0,1424380312],[8,71,1.0,1424380312],[8,72,3.0,1424380312],[8,77,3.0,1424380312],[8,78,1.0,1424380312],[8,79,1.0,1424380312],[8,83,1.0,1424380312],[8,85,5.0,1424380312],[8,86,1.0,1424380312],[8,88,1.0,1424380312],[8,90,1.0,1424380312],[8,92,2.0,1424380312],[8,95,4.0,1424380312],[8,96,3.0,1424380312],[8,97,1.0,1424380312],[8,98,1.0,1424380312],[8,99,1.0,1424380312],[9,2,3.0,1424380312],[9,3,1.0,1424380312],[9,4,1.0,1424380312],[9,5,1.0,1424380312],[9,6,1.0,1424380312],[9,7,5.0,1424380312],[9,9,1.0,1424380312],[9,12,1.0,1424380312],[9,14,3.0,1424380312],[9,15,1.0,1424380312],[9,19,1.0,1424380312],[9,21,1.0,1424380312],[9,22,1.0,1424380312],[9,24,1.0,1424380312],[9,25,1.0,1424380312],[9,26,1.0,1424380312],[9,30,3.0,1424380312],[9,32,4.0,1424380312],[9,35,2.0,1424380312],[9,36,2.0,1424380312],[9,37,2.0,1424380312],[9,38,1.0,1424380312],[9,39,1.0,1424380312],[9,43,3.0,1424380312],[9,49,5.0,1424380312],[9,50,3.0,1424380312],[9,53,1.0,1424380312],[9,54,1.0,1424380312],[9,58,1.0,1424380312],[9,59,1.0,1424380312],[9,60,1.0,1424380312],[9,61,1.0,1424380312],[9,63,3.0,1424380312],[9,64,3.0,1424380312],[9,68,1.0,1424380312],[9,69,1.0,1424380312],[9,70,3.0,1424380312],[9,71,1.0,1424380312],[9,73,2.0,1424380312],[9,75,1.0,1424380312],[9,77,2.0,1424380312],[9,81,2.0,1424380312],[9,82,1.0,1424380312],[9,83,1.0,1424380312],[9,84,1.0,1424380312],[9,86,1.0,1424380312],[9,87,4.0,1424380312],[9,88,1.0,1424380312],[9,90,3.0,1424380312],[9,94,2.0,1424380312],[9,95,3.0,1424380312],[9,97,2.0,1424380312],[9,98,1.0,1424380312],[10,0,3.0,1424380312],[10,2,4.0,1424380312],[10,4,3.0,1424380312],[10,7,1.0,1424380312],[10,8,1.0,1424380312],[10,10,1.0,1424380312],[10,13,2.0,1424380312],[10,14,1.0,1424380312],[10,16,2.0,1424380312],[10,17,1.0,1424380312],[10,18,1.0,1424380312],[10,21,1.0,1424380312],[10,22,1.0,1424380312],[10,24,1.0,1424380312],[10,25,3.0,1424380312],[10,28,1.0,1424380312],[10,35,1.0,1424380312],[10,36,1.0,1424380312],[10,37,1.0,1424380312],[10,38,1.0,1424380312],[10,39,1.0,1424380312],[10,40,4.0,1424380312],[10,41,2.0,1424380312],[10,42,3.0,1424380312],[10,43,1.0,1424380312],[10,49,3.0,1424380312],[10,50,1.0,1424380312],[10,51,1.0,1424380312],[10,52,1.0,1424380312],[10,55,2.0,1424380312],[10,56,1.0,1424380312],[10,58,1.0,1424380312],[10,63,1.0,1424380312],[10,66,1.0,1424380312],[10,67,2.0,1424380312],[10,68,1.0,1424380312],[10,75,1.0,1424380312],[10,77,1.0,1424380312],[10,79,1.0,1424380312],[10,86,1.0,1424380312],[10,89,3.0,1424380312],[10,90,1.0,1424380312],[10,97,1.0,1424380312],[10,98,1.0,1424380312],[11,0,1.0,1424380312],[11,6,2.0,1424380312],[11,9,1.0,1424380312],[11,10,1.0,1424380312],[11,11,1.0,1424380312],[11,12,1.0,1424380312],[11,13,4.0,1424380312],[11,16,1.0,1424380312],[11,18,5.0,1424380312],[11,19,4.0,1424380312],[11,20,1.0,1424380312],[11,21,1.0,1424380312],[11,22,1.0,1424380312],[11,23,5.0,1424380312],[11,25,1.0,1424380312],[11,27,5.0,1424380312],[11,30,5.0,1424380312],[11,32,5.0,1424380312],[11,35,3.0,1424380312],[11,36,2.0,1424380312],[11,37,2.0,1424380312],[11,38,4.0,1424380312],[11,39,1.0,1424380312],[11,40,1.0,1424380312],[11,41,1.0,1424380312],[11,43,2.0,1424380312],[11,45,1.0,1424380312],[11,47,1.0,1424380312],[11,48,5.0,1424380312],[11,50,4.0,1424380312],[11,51,3.0,1424380312],[11,59,1.0,1424380312],[11,61,1.0,1424380312],[11,62,1.0,1424380312],[11,64,1.0,1424380312],[11,66,4.0,1424380312],[11,67,1.0,1424380312],[11,69,5.0,1424380312],[11,70,1.0,1424380312],[11,71,3.0,1424380312],[11,72,3.0,1424380312],[11,75,3.0,1424380312],[11,76,1.0,1424380312],[11,77,1.0,1424380312],[11,78,1.0,1424380312],[11,79,5.0,1424380312],[11,80,3.0,1424380312],[11,81,4.0,1424380312],[11,82,1.0,1424380312],[11,86,1.0,1424380312],[11,88,1.0,1424380312],[11,89,1.0,1424380312],[11,90,4.0,1424380312],[11,94,2.0,1424380312],[11,97,3.0,1424380312],[11,99,1.0,1424380312],[12,2,1.0,1424380312],[12,4,1.0,1424380312],[12,6,1.0,1424380312],[12,7,3.0,1424380312],[12,8,1.0,1424380312],[12,14,1.0,1424380312],[12,15,2.0,1424380312],[12,16,4.0,1424380312],[12,17,5.0,1424380312],[12,18,2.0,1424380312],[12,21,1.0,1424380312],[12,22,2.0,1424380312],[12,23,3.0,1424380312],[12,24,1.0,1424380312],[12,25,1.0,1424380312],[12,27,5.0,1424380312],[12,30,2.0,1424380312],[12,31,4.0,1424380312],[12,35,5.0,1424380312],[12,38,1.0,1424380312],[12,41,1.0,1424380312],[12,44,2.0,1424380312],[12,45,1.0,1424380312],[12,50,4.0,1424380312],[12,51,1.0,1424380312],[12,52,1.0,1424380312],[12,53,1.0,1424380312],[12,54,1.0,1424380312],[12,56,2.0,1424380312],[12,57,1.0,1424380312],[12,60,1.0,1424380312],[12,63,1.0,1424380312],[12,64,5.0,1424380312],[12,66,3.0,1424380312],[12,67,1.0,1424380312],[12,70,1.0,1424380312],[12,72,1.0,1424380312],[12,74,1.0,1424380312],[12,75,1.0,1424380312],[12,77,1.0,1424380312],[12,78,1.0,1424380312],[12,79,3.0,1424380312],[12,82,2.0,1424380312],[12,83,1.0,1424380312],[12,84,1.0,1424380312],[12,85,1.0,1424380312],[12,86,1.0,1424380312],[12,87,1.0,1424380312],[12,88,1.0,1424380312],[12,91,3.0,1424380312],[12,92,1.0,1424380312],[12,94,4.0,1424380312],[12,95,2.0,1424380312],[12,96,1.0,1424380312],[12,98,2.0,1424380312],[13,0,1.0,1424380312],[13,3,1.0,1424380312],[13,4,2.0,1424380312],[13,5,1.0,1424380312],[13,6,1.0,1424380312],[13,12,1.0,1424380312],[13,14,2.0,1424380312],[13,15,1.0,1424380312],[13,17,1.0,1424380312],[13,18,3.0,1424380312],[13,20,1.0,1424380312],[13,21,1.0,1424380312],[13,22,1.0,1424380312],[13,26,1.0,1424380312],[13,27,1.0,1424380312],[13,29,3.0,1424380312],[13,31,1.0,1424380312],[13,33,1.0,1424380312],[13,40,2.0,1424380312],[13,43,2.0,1424380312],[13,44,1.0,1424380312],[13,45,1.0,1424380312],[13,49,1.0,1424380312],[13,51,1.0,1424380312],[13,52,2.0,1424380312],[13,53,3.0,1424380312],[13,54,1.0,1424380312],[13,62,1.0,1424380312],[13,63,2.0,1424380312],[13,64,1.0,1424380312],[13,68,1.0,1424380312],[13,71,1.0,1424380312],[13,72,3.0,1424380312],[13,73,1.0,1424380312],[13,74,3.0,1424380312],[13,77,2.0,1424380312],[13,78,1.0,1424380312],[13,79,2.0,1424380312],[13,83,3.0,1424380312],[13,85,1.0,1424380312],[13,86,1.0,1424380312],[13,87,2.0,1424380312],[13,88,2.0,1424380312],[13,90,1.0,1424380312],[13,93,4.0,1424380312],[13,94,1.0,1424380312],[13,98,1.0,1424380312],[13,99,1.0,1424380312],[14,1,1.0,1424380312],[14,3,3.0,1424380312],[14,4,1.0,1424380312],[14,5,1.0,1424380312],[14,6,1.0,1424380312],[14,7,1.0,1424380312],[14,9,1.0,1424380312],[14,10,1.0,1424380312],[14,11,1.0,1424380312],[14,12,1.0,1424380312],[14,13,1.0,1424380312],[14,14,3.0,1424380312],[14,15,1.0,1424380312],[14,16,1.0,1424380312],[14,17,1.0,1424380312],[14,20,1.0,1424380312],[14,21,1.0,1424380312],[14,24,1.0,1424380312],[14,25,2.0,1424380312],[14,27,1.0,1424380312],[14,28,1.0,1424380312],[14,29,5.0,1424380312],[14,31,3.0,1424380312],[14,34,1.0,1424380312],[14,36,1.0,1424380312],[14,37,2.0,1424380312],[14,39,2.0,1424380312],[14,40,1.0,1424380312],[14,44,1.0,1424380312],[14,45,1.0,1424380312],[14,47,3.0,1424380312],[14,48,1.0,1424380312],[14,49,1.0,1424380312],[14,51,1.0,1424380312],[14,52,5.0,1424380312],[14,53,3.0,1424380312],[14,54,1.0,1424380312],[14,55,1.0,1424380312],[14,56,1.0,1424380312],[14,62,4.0,1424380312],[14,63,5.0,1424380312],[14,67,3.0,1424380312],[14,68,1.0,1424380312],[14,69,3.0,1424380312],[14,71,1.0,1424380312],[14,72,4.0,1424380312],[14,73,1.0,1424380312],[14,76,5.0,1424380312],[14,79,1.0,1424380312],[14,82,1.0,1424380312],[14,83,1.0,1424380312],[14,88,1.0,1424380312],[14,93,3.0,1424380312],[14,94,1.0,1424380312],[14,95,2.0,1424380312],[14,96,4.0,1424380312],[14,98,1.0,1424380312],[15,0,1.0,1424380312],[15,1,4.0,1424380312],[15,2,1.0,1424380312],[15,5,2.0,1424380312],[15,6,1.0,1424380312],[15,7,1.0,1424380312],[15,13,1.0,1424380312],[15,14,1.0,1424380312],[15,15,1.0,1424380312],[15,17,2.0,1424380312],[15,19,2.0,1424380312],[15,22,2.0,1424380312],[15,23,2.0,1424380312],[15,25,1.0,1424380312],[15,26,3.0,1424380312],[15,27,1.0,1424380312],[15,28,2.0,1424380312],[15,29,1.0,1424380312],[15,32,1.0,1424380312],[15,33,2.0,1424380312],[15,34,1.0,1424380312],[15,35,2.0,1424380312],[15,36,1.0,1424380312],[15,37,1.0,1424380312],[15,39,1.0,1424380312],[15,42,1.0,1424380312],[15,46,5.0,1424380312],[15,48,2.0,1424380312],[15,50,2.0,1424380312],[15,51,1.0,1424380312],[15,52,1.0,1424380312],[15,58,1.0,1424380312],[15,62,1.0,1424380312],[15,64,3.0,1424380312],[15,65,2.0,1424380312],[15,72,1.0,1424380312],[15,73,1.0,1424380312],[15,74,1.0,1424380312],[15,79,1.0,1424380312],[15,80,1.0,1424380312],[15,81,1.0,1424380312],[15,82,2.0,1424380312],[15,85,1.0,1424380312],[15,87,1.0,1424380312],[15,91,2.0,1424380312],[15,96,1.0,1424380312],[15,97,1.0,1424380312],[15,98,3.0,1424380312],[16,2,1.0,1424380312],[16,5,3.0,1424380312],[16,6,2.0,1424380312],[16,7,1.0,1424380312],[16,9,1.0,1424380312],[16,12,1.0,1424380312],[16,14,1.0,1424380312],[16,15,1.0,1424380312],[16,19,1.0,1424380312],[16,21,2.0,1424380312],[16,29,4.0,1424380312],[16,30,2.0,1424380312],[16,32,1.0,1424380312],[16,34,1.0,1424380312],[16,36,1.0,1424380312],[16,38,1.0,1424380312],[16,46,1.0,1424380312],[16,47,3.0,1424380312],[16,48,1.0,1424380312],[16,49,1.0,1424380312],[16,50,1.0,1424380312],[16,51,5.0,1424380312],[16,54,5.0,1424380312],[16,55,1.0,1424380312],[16,56,2.0,1424380312],[16,57,1.0,1424380312],[16,60,1.0,1424380312],[16,63,2.0,1424380312],[16,65,1.0,1424380312],[16,67,1.0,1424380312],[16,72,1.0,1424380312],[16,74,1.0,1424380312],[16,80,1.0,1424380312],[16,81,1.0,1424380312],[16,82,1.0,1424380312],[16,85,5.0,1424380312],[16,86,1.0,1424380312],[16,90,5.0,1424380312],[16,91,1.0,1424380312],[16,93,1.0,1424380312],[16,94,3.0,1424380312],[16,95,2.0,1424380312],[16,96,3.0,1424380312],[16,98,3.0,1424380312],[16,99,1.0,1424380312],[17,2,1.0,1424380312],[17,3,1.0,1424380312],[17,6,1.0,1424380312],[17,10,4.0,1424380312],[17,11,1.0,1424380312],[17,13,2.0,1424380312],[17,17,5.0,1424380312],[17,19,1.0,1424380312],[17,20,5.0,1424380312],[17,22,4.0,1424380312],[17,28,1.0,1424380312],[17,29,1.0,1424380312],[17,33,1.0,1424380312],[17,34,1.0,1424380312],[17,35,2.0,1424380312],[17,37,1.0,1424380312],[17,38,1.0,1424380312],[17,45,1.0,1424380312],[17,46,5.0,1424380312],[17,47,1.0,1424380312],[17,49,3.0,1424380312],[17,51,1.0,1424380312],[17,55,5.0,1424380312],[17,56,3.0,1424380312],[17,57,1.0,1424380312],[17,58,1.0,1424380312],[17,59,1.0,1424380312],[17,60,1.0,1424380312],[17,63,1.0,1424380312],[17,66,1.0,1424380312],[17,68,4.0,1424380312],[17,69,1.0,1424380312],[17,70,1.0,1424380312],[17,72,1.0,1424380312],[17,73,3.0,1424380312],[17,78,1.0,1424380312],[17,79,1.0,1424380312],[17,82,2.0,1424380312],[17,84,1.0,1424380312],[17,90,5.0,1424380312],[17,91,3.0,1424380312],[17,92,1.0,1424380312],[17,93,1.0,1424380312],[17,94,4.0,1424380312],[17,95,2.0,1424380312],[17,97,1.0,1424380312],[18,1,1.0,1424380312],[18,4,3.0,1424380312],[18,5,2.0,1424380312],[18,6,1.0,1424380312],[18,7,1.0,1424380312],[18,10,1.0,1424380312],[18,11,4.0,1424380312],[18,12,2.0,1424380312],[18,13,1.0,1424380312],[18,15,1.0,1424380312],[18,18,1.0,1424380312],[18,20,1.0,1424380312],[18,21,2.0,1424380312],[18,22,1.0,1424380312],[18,23,2.0,1424380312],[18,25,1.0,1424380312],[18,26,1.0,1424380312],[18,27,1.0,1424380312],[18,28,5.0,1424380312],[18,29,1.0,1424380312],[18,31,1.0,1424380312],[18,32,1.0,1424380312],[18,36,1.0,1424380312],[18,38,5.0,1424380312],[18,39,5.0,1424380312],[18,40,1.0,1424380312],[18,42,1.0,1424380312],[18,43,1.0,1424380312],[18,44,4.0,1424380312],[18,46,1.0,1424380312],[18,47,1.0,1424380312],[18,48,1.0,1424380312],[18,51,2.0,1424380312],[18,55,1.0,1424380312],[18,56,1.0,1424380312],[18,57,1.0,1424380312],[18,62,1.0,1424380312],[18,63,1.0,1424380312],[18,66,3.0,1424380312],[18,67,1.0,1424380312],[18,70,1.0,1424380312],[18,75,1.0,1424380312],[18,76,3.0,1424380312],[18,77,1.0,1424380312],[18,80,3.0,1424380312],[18,81,3.0,1424380312],[18,82,1.0,1424380312],[18,83,5.0,1424380312],[18,84,1.0,1424380312],[18,97,1.0,1424380312],[18,98,1.0,1424380312],[18,99,2.0,1424380312],[19,0,1.0,1424380312],[19,1,1.0,1424380312],[19,2,1.0,1424380312],[19,4,1.0,1424380312],[19,6,2.0,1424380312],[19,11,1.0,1424380312],[19,12,1.0,1424380312],[19,14,1.0,1424380312],[19,23,1.0,1424380312],[19,26,1.0,1424380312],[19,31,1.0,1424380312],[19,32,4.0,1424380312],[19,33,1.0,1424380312],[19,34,1.0,1424380312],[19,37,1.0,1424380312],[19,38,1.0,1424380312],[19,41,1.0,1424380312],[19,43,1.0,1424380312],[19,45,1.0,1424380312],[19,48,1.0,1424380312],[19,49,1.0,1424380312],[19,50,2.0,1424380312],[19,53,2.0,1424380312],[19,54,3.0,1424380312],[19,55,1.0,1424380312],[19,56,2.0,1424380312],[19,58,1.0,1424380312],[19,61,1.0,1424380312],[19,62,1.0,1424380312],[19,63,1.0,1424380312],[19,64,1.0,1424380312],[19,65,1.0,1424380312],[19,69,2.0,1424380312],[19,72,1.0,1424380312],[19,74,3.0,1424380312],[19,76,1.0,1424380312],[19,78,1.0,1424380312],[19,79,1.0,1424380312],[19,81,1.0,1424380312],[19,82,1.0,1424380312]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"integer\"","metadata":"{}"},{"name":"movieId","type":"\"integer\"","metadata":"{}"},{"name":"rating","type":"\"float\"","metadata":"{}"},{"name":"timestamp","type":"\"long\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"ratings","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"userId","type":"integer","nullable":true,"metadata":{}},{"name":"movieId","type":"integer","nullable":true,"metadata":{}},{"name":"rating","type":"float","nullable":true,"metadata":{}},{"name":"timestamp","type":"long","nullable":true,"metadata":{}}]},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949436631,"submitTime":1653949436147,"finishTime":1653949480081,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"465","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1000]],"subcommandOptions":null,"nuid":"aee30e91-7ca3-4d7c-88cf-ddb47f4bed1e"},{"version":"CommandV1","origId":2178463341864268,"guid":"21cedcf2-f8e2-461a-86f4-eb56a27cecfc","subtype":"command","commandType":"auto","position":3.0,"command":"import org.apache.spark.ml.recommendation.ALS\n\nval Array(training, test) = ratings.randomSplit(Array(0.8, 0.2))\n\nval als = new ALS()\n  .setMaxIter(5)\n  .setRegParam(0.01)\n//   .setRank(10)\n  .setUserCol(\"userId\")\n  .setItemCol(\"movieId\")\n  .setRatingCol(\"rating\")\n\nprintln(als.explainParams())","commandVersion":27,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">alpha: alpha for implicit preference (default: 1.0)\nblockSize: block size for stacking input data in matrices. Data is stacked within partitions. If block size is more than remaining data in a partition then it is adjusted to the size of this data. (default: 4096)\ncheckpointInterval: set checkpoint interval (&gt;= 1) or disable checkpoint (-1). E.g. 10 means that the cache will get checkpointed every 10 iterations. Note: this setting will be ignored if the checkpoint directory is not set in the SparkContext (default: 10)\ncoldStartStrategy: strategy for dealing with unknown or new users/items at prediction time. This may be useful in cross-validation or production scenarios, for handling user/item ids the model has not seen in the training data. Supported values: nan,drop. (default: nan)\nfinalStorageLevel: StorageLevel for ALS model factors. (default: MEMORY_AND_DISK)\nimplicitPrefs: whether to use implicit preference (default: false)\nintermediateStorageLevel: StorageLevel for intermediate datasets. Cannot be 'NONE'. (default: MEMORY_AND_DISK)\nitemCol: column name for item ids. Ids must be within the integer value range. (default: item, current: movieId)\nmaxIter: maximum number of iterations (&gt;= 0) (default: 10, current: 5)\nnonnegative: whether to use nonnegative constraint for least squares (default: false)\nnumItemBlocks: number of item blocks (default: 10)\nnumUserBlocks: number of user blocks (default: 10)\npredictionCol: prediction column name (default: prediction)\nrank: rank of the factorization (default: 10)\nratingCol: column name for ratings (default: rating, current: rating)\nregParam: regularization parameter (&gt;= 0) (default: 0.1, current: 0.02)\nseed: random seed (default: 1994790107)\nuserCol: column name for user ids. Ids must be within the integer value range. (default: user, current: userId)\nimport org.apache.spark.ml.recommendation.ALS\ntraining: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userId: int, movieId: int ... 2 more fields]\ntest: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userId: int, movieId: int ... 2 more fields]\nals: org.apache.spark.ml.recommendation.ALS = als_58bc56df2205\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"training","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"userId","type":"integer","nullable":true,"metadata":{}},{"name":"movieId","type":"integer","nullable":true,"metadata":{}},{"name":"rating","type":"float","nullable":true,"metadata":{}},{"name":"timestamp","type":"long","nullable":true,"metadata":{}}]},"tableIdentifier":null},{"name":"test","typeStr":"org.apache.spark.sql.Dataset[org.apache.spark.sql.Row]","schema":{"type":"struct","fields":[{"name":"userId","type":"integer","nullable":true,"metadata":{}},{"name":"movieId","type":"integer","nullable":true,"metadata":{}},{"name":"rating","type":"float","nullable":true,"metadata":{}},{"name":"timestamp","type":"long","nullable":true,"metadata":{}}]},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949495297,"submitTime":1653949436226,"finishTime":1653949497548,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",2194]],"subcommandOptions":null,"nuid":"8a31f427-1224-4325-9c93-99a87455f294"},{"version":"CommandV1","origId":2178463341864269,"guid":"caf98baf-93d1-4747-b312-064558873ef5","subtype":"command","commandType":"auto","position":4.0,"command":"val alsModel = als.fit(training)\n\nval predictions = alsModel.transform(test)","commandVersion":4,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">alsModel: org.apache.spark.ml.recommendation.ALSModel = ALSModel: uid=als_58bc56df2205, rank=10\npredictions: org.apache.spark.sql.DataFrame = [userId: int, movieId: int ... 3 more fields]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"predictions","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"userId","type":"integer","nullable":true,"metadata":{}},{"name":"movieId","type":"integer","nullable":true,"metadata":{}},{"name":"rating","type":"float","nullable":true,"metadata":{}},{"name":"timestamp","type":"long","nullable":true,"metadata":{}},{"name":"prediction","type":"float","nullable":false,"metadata":{}}]},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949497571,"submitTime":1653949436240,"finishTime":1653949513535,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",215]],"subcommandOptions":null,"nuid":"a0244aa0-4a53-46aa-9266-2dddcdd88a4a"},{"version":"CommandV1","origId":2178463341864270,"guid":"f39b61ae-a3df-4363-b0b8-c5fc5a2bfa59","subtype":"command","commandType":"auto","position":5.0,"command":"display(\n  alsModel\n    .recommendForAllUsers(5)\n    .selectExpr(\"userId\", \"explode(recommendations)\")\n)","commandVersion":17,"state":"finished","results":{"type":"table","data":[[20,[22,4.2429175]],[20,[75,4.0554404]],[20,[32,3.717928]],[20,[94,3.632936]],[20,[23,3.2630033]],[10,[85,4.0521793]],[10,[30,3.9860115]],[10,[40,3.7522955]],[10,[2,3.6043282]],[10,[23,3.463223]],[0,[92,3.7512398]],[0,[39,3.5873928]],[0,[62,3.4220448]],[0,[91,2.9111795]],[0,[70,2.8341026]],[1,[75,3.7316453]],[1,[22,3.062876]],[1,[85,3.0379956]],[1,[32,2.861025]],[1,[28,2.803992]],[21,[29,5.1032534]],[21,[53,4.7675815]],[21,[87,3.9684672]],[21,[2,3.8326814]],[21,[74,3.830272]],[11,[32,5.1788282]],[11,[49,5.061259]],[11,[30,5.0352893]],[11,[69,4.8370075]],[11,[27,4.8369465]],[12,[46,6.712355]],[12,[90,6.406448]],[12,[64,4.8647003]],[12,[32,4.364762]],[12,[35,4.3495855]],[22,[88,5.252849]],[22,[75,4.8449583]],[22,[22,4.7415266]],[22,[30,4.731054]],[22,[49,4.063749]],[2,[51,5.21026]],[2,[83,5.180356]],[2,[39,5.0505037]],[2,[8,5.0062323]],[2,[37,4.871336]],[13,[29,4.0998645]],[13,[93,4.06029]],[13,[52,3.716133]],[13,[51,3.5757594]],[13,[96,3.5212958]],[3,[51,4.5706415]],[3,[69,4.2801285]],[3,[90,4.0831776]],[3,[80,3.9687793]],[3,[18,3.8884242]],[23,[32,5.0364065]],[23,[55,4.834415]],[23,[48,4.5989413]],[23,[90,4.5194917]],[23,[49,4.347394]],[4,[62,4.079312]],[4,[29,3.7750576]],[4,[70,3.3459463]],[4,[63,3.2857537]],[4,[52,2.9471858]],[24,[69,5.0625715]],[24,[52,5.0343246]],[24,[96,5.0179453]],[24,[30,4.9603434]],[24,[90,4.5977902]],[14,[52,5.155545]],[14,[29,5.089897]],[14,[63,4.566692]],[14,[76,4.3026795]],[14,[58,3.9483085]],[5,[32,4.5487056]],[5,[55,3.795765]],[5,[49,3.780525]],[5,[90,3.5516787]],[5,[48,3.3988132]],[15,[46,4.8939204]],[15,[1,3.7835312]],[15,[90,3.6060429]],[15,[54,3.1265404]],[15,[47,3.0118659]],[25,[90,4.2054563]],[25,[46,4.0764647]],[25,[33,3.8682733]],[25,[47,3.7624753]],[25,[28,3.4837542]],[26,[22,5.4508266]],[26,[94,5.3546877]],[26,[24,4.9231367]],[26,[88,4.891133]],[26,[23,4.8901234]],[6,[25,4.514513]],[6,[29,3.8266416]],[6,[58,3.8200448]],[6,[52,3.6461256]],[6,[85,3.1852279]],[16,[92,6.1770964]],[16,[39,5.5298185]],[16,[93,5.1390524]],[16,[66,4.887968]],[16,[51,4.83992]],[27,[85,3.5099983]],[27,[9,3.4850595]],[27,[39,3.4022813]],[27,[19,3.3412805]],[27,[12,3.3370526]],[17,[90,5.040891]],[17,[55,4.9021816]],[17,[48,4.8941774]],[17,[17,4.8449035]],[17,[20,4.7424645]],[7,[25,4.831085]],[7,[85,4.055633]],[7,[29,3.6567948]],[7,[58,3.4675517]],[7,[62,3.1523027]],[28,[81,4.952665]],[28,[92,4.9145]],[28,[30,4.2120705]],[28,[89,4.0443707]],[28,[49,3.9610868]],[8,[29,5.048795]],[8,[52,4.729466]],[8,[85,4.5589566]],[8,[25,4.2687206]],[8,[2,4.227899]],[18,[28,4.8756266]],[18,[39,4.8277707]],[18,[38,4.809927]],[18,[92,4.4440875]],[18,[90,4.0897965]],[19,[46,4.3395596]],[19,[98,3.8206558]],[19,[32,3.7906537]],[19,[75,3.612342]],[19,[94,3.5937486]],[9,[49,4.74908]],[9,[30,3.959028]],[9,[32,3.9129004]],[9,[87,3.8108332]],[9,[90,3.6323595]],[29,[46,4.9129753]],[29,[90,4.443372]],[29,[32,4.058549]],[29,[94,3.92376]],[29,[23,3.7936614]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"integer\"","metadata":"{}"},{"name":"col","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"movieId\",\"type\":\"integer\",\"nullable\":true,\"metadata\":{}},{\"name\":\"rating\",\"type\":\"float\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653950725263,"submitTime":1653950725249,"finishTime":1653950736980,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"623","height":"582","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",150]],"subcommandOptions":null,"nuid":"6ba1059a-31c9-49e2-90d3-55ec8e421a99"},{"version":"CommandV1","origId":2178463341864273,"guid":"ecd01c6d-0e81-4cf6-b7b1-fb250302d103","subtype":"command","commandType":"auto","position":6.5,"command":"%md\n# Evaluators for Recommendation","commandVersion":3,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"ca09b13c-1141-4268-97e3-5ff0c35c37ad"},{"version":"CommandV1","origId":2178463341864274,"guid":"75108c7d-8413-4561-83c0-97091371da38","subtype":"command","commandType":"auto","position":6.75,"command":"// in Scala\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nval evaluator = new RegressionEvaluator()\n  .setMetricName(\"rmse\")\n  .setLabelCol(\"rating\")\n  .setPredictionCol(\"prediction\")\n\nval rmse = evaluator.evaluate(predictions)\n\nprintln(s\"Root-mean-square error = $rmse\")\n\n// How concentrated the data is around the best fit.","commandVersion":45,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Root-mean-square error = 1.5511414351691184\nimport org.apache.spark.ml.evaluation.RegressionEvaluator\nevaluator: org.apache.spark.ml.evaluation.RegressionEvaluator = RegressionEvaluator: uid=regEval_7461d26c3489, metricName=rmse, throughOrigin=false\nrmse: Double = 1.5511414351691184\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949545346,"submitTime":1653949436313,"finishTime":1653949550710,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",311]],"subcommandOptions":null,"nuid":"8ecbaec1-bcae-4fdb-8ff0-2b097060989a"},{"version":"CommandV1","origId":2178463341864275,"guid":"d12adf3f-1af9-4a57-b64a-80c178e7021e","subtype":"command","commandType":"auto","position":8.0,"command":"// in Scala\nval perUserActualvPred = perUserActual\n  .join(perUserPredictions, Seq(\"userId\"))\n  .map(row => (\n    row(1).asInstanceOf[Seq[Integer]].toArray,\n    row(2).asInstanceOf[Seq[Integer]].toArray.take(15)\n  ))\n\ndisplay(perUserActualvPred)","commandVersion":17,"state":"finished","results":{"type":"table","data":[[[12,19,82],[13,45,38,58,99,82,75,12,33,19]],[[27,18,44],[9,28,61,18,86,94,64,44,27,43]],[[27,31,17,91],[54,17,6,56,27,96,31,91,82,15,24,88,85,57]],[[51,88,74],[88,81,51,74,6,40,99,16,11,37,33]],[[68,62,77],[19,62,77,68,36,70,40,72,78,44,91]],[[74,29],[29,52,51,90,77,64,74,12,14,44,45,5]],[[63,43,61],[96,39,30,63,81,44,43,45,54,94,15,5,49,61,60]],[[60,7],[60,72,7,66,86,91,84]],[[77],[32,24,92,60,77,4,55,61,84]],[[13,20,50,68,55],[55,20,50,27,95,68,60,13,61,91,65,15,38,58,31]],[[90],[23,90,1,41,79,86,34,84,31,82,48]],[[64,26],[13,32,64,17,26,6,82,87,28]],[[30,70,32,90,7,14,95],[30,32,90,69,81,95,4,71,82,14,70,24,7,98,37]],[[46,22,91],[22,45,46,6,29,58,91,92,13,63,34,47]],[[52,41],[52,14,22,9,78,41,34,11,6]],[[60,31,53],[53,31,71,60,15,54]],[[27,13,49,10,73,65],[49,10,27,4,13,73,65,61,39,59,33,38,14,37]],[[47],[47,53,59,44,61,32,97,49]],[[42],[50,79,86,58,66,56,36,41,42,38]],[[16,71],[22,16,36,26,71,97,82,23,40]],[[63,72,59],[4,67,99,10,72,63,80,59,89]],[[38,68,10],[10,68,80,51,74,59,99,38]],[[96,59],[96,0,54,46,99,59,92,48,44,12,11,38]],[[48,19,38,18,72],[38,48,6,78,72,9,18,19,37]],[[53,72,76,14],[76,72,14,39,1,53,12,11,73,71,6,28]],[[34,89],[85,28,89,58,87,34,59]],[[9,2],[9,48,11,21,2,31,37,41]],[[83,80],[25,83,62,21,23,82,80]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"_1","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"},{"name":"_2","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"perUserActualvPred","typeStr":"org.apache.spark.sql.Dataset[(Array[Integer], Array[Integer])]","schema":{"type":"struct","fields":[{"name":"_1","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{}},{"name":"_2","type":{"type":"array","elementType":"integer","containsNull":true},"nullable":true,"metadata":{}}]},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949565422,"submitTime":1653949436434,"finishTime":1653949576332,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"645","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",28]],"subcommandOptions":null,"nuid":"669379ed-015e-4c68-9cf9-d44473a19034"},{"version":"CommandV1","origId":2178463341864276,"guid":"b420331b-b3e6-4048-9e41-0edbb245c068","subtype":"command","commandType":"auto","position":7.5,"command":"// in Scala\nimport org.apache.spark.mllib.evaluation.{\n  RankingMetrics,\n  RegressionMetrics\n}\n\nval regComparison = predictions\n  .select(\"rating\", \"prediction\")\n  .rdd.map(x => (x.getFloat(0).toDouble,x.getFloat(1).toDouble))\n\nval metrics = new RegressionMetrics(regComparison)\n\nprintln(\"metrics.explainedVariance: \" + metrics.explainedVariance)\nprintln(\"metrics.meanAbsoluteError: \" + metrics.meanAbsoluteError)\nprintln(\"metrics.meanSquaredError: \" + metrics.meanSquaredError)\nprintln(\"metrics.r2: \" + metrics.r2)\nprintln(\"metrics.rootMeanSquaredError: \" + metrics.rootMeanSquaredError)","commandVersion":37,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">metrics.explainedVariance: 1.7478332088870436\nmetrics.meanAbsoluteError: 1.1758904719959624\nmetrics.meanSquaredError: 2.406039751898512\nmetrics.r2: -0.6883507037688459\nmetrics.rootMeanSquaredError: 1.5511414351691184\nimport org.apache.spark.mllib.evaluation.{RankingMetrics, RegressionMetrics}\nregComparison: org.apache.spark.rdd.RDD[(Double, Double)] = MapPartitionsRDD[619] at map at command-2178463341864276:9\nmetrics: org.apache.spark.mllib.evaluation.RegressionMetrics = org.apache.spark.mllib.evaluation.RegressionMetrics@70a963c2\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653951569723,"submitTime":1653951569706,"finishTime":1653951572794,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",564]],"subcommandOptions":null,"nuid":"fef7e1c6-a0a0-41be-90c1-b17aa234ed8d"},{"version":"CommandV1","origId":2178463341864277,"guid":"377064b0-2ea2-42c7-ba31-6687ffbeb275","subtype":"command","commandType":"auto","position":7.75,"command":"// in Scala\nval perUserPredictions = predictions\n.orderBy(col(\"userId\"), col(\"prediction\").desc)\n.groupBy(\"userId\")\n.agg(expr(\"collect_list(movieId) as movies\"))\n\ndisplay(perUserPredictions)","commandVersion":11,"state":"finished","results":{"type":"table","data":[[28,[13,45,38,58,99,82,75,12,33,19]],[26,[62,71]],[27,[9,28,61,18,86,94,64,44,27,43]],[12,[54,17,6,56,27,96,31,91,82,15,24,88,85,57]],[22,[88,81,51,74,6,40,99,16,11,37,33]],[1,[19,62,77,68,36,70,40,72,78,44,91]],[13,[29,52,51,90,77,64,74,12,14,44,45,5]],[6,[96,39,30,63,81,44,43,45,54,94,15,5,49,61,60,9]],[16,[93,46,81,72,15,14,60]],[3,[60,72,7,66,86,91,84]],[20,[32,24,92,60,77,4,55,61,84]],[5,[55,20,50,27,95,68,60,13,61,91,65,15,38,58,31,8]],[19,[23,90,1,41,79,86,34,84,31,82,48]],[15,[13,32,64,17,26,6,82,87,28]],[9,[30,32,90,69,81,95,4,71,82,14,70,24,7,98,37,73,19]],[17,[22,45,46,6,29,58,91,92,13,63,34,47]],[4,[52,14,22,9,78,41,34,11,6]],[8,[53,31,71,60,15,54]],[23,[49,10,27,4,13,73,65,61,39,59,33,38,14,37]],[7,[47,53,59,44,61,32,97,49]],[10,[50,79,86,58,66,56,36,41,42,38]],[25,[22,16,36,26,71,97,82,23,40]],[24,[4,67,99,10,72,63,80,59,89]],[29,[10,68,80,51,74,59,99,38]],[21,[96,0,54,46,99,59,92,48,44,12,11,38]],[11,[38,48,6,78,72,9,18,19,37]],[14,[76,72,14,39,1,53,12,11,73,71,6,28]],[2,[85,28,89,58,87,34,59]],[0,[9,48,11,21,2,31,37,41]],[18,[25,83,62,21,23,82,80]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"integer\"","metadata":"{}"},{"name":"movies","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":false}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"perUserPredictions","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"userId","type":"integer","nullable":true,"metadata":{}},{"name":"movies","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":false,"metadata":{}}]},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949560185,"submitTime":1653949436417,"finishTime":1653949565400,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"565","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",30]],"subcommandOptions":null,"nuid":"4ec9eb32-5f09-4992-a970-e1d4e76e3a55"},{"version":"CommandV1","origId":2178463341864278,"guid":"910207f8-ca3b-4bfb-a0b6-a4437032f94d","subtype":"command","commandType":"auto","position":7.625,"command":"%md\n## Ranking Metrics","commandVersion":4,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"nuid":"2d14c032-f22d-4739-b4ce-9317f549e5b3"},{"version":"CommandV1","origId":2178463341864279,"guid":"6c3a7214-48ef-49c1-b36b-c90b749917f8","subtype":"command","commandType":"auto","position":7.6875,"command":"// in Scalaimport org.apache.spark.mllib.evaluation.{RankingMetrics, RegressionMetrics}\nimport org.apache.spark.sql.functions.{col, expr}\n\nval perUserActual = predictions\n  .where(\"rating > 2.5\")\n  .groupBy(\"userId\")\n  .agg(expr(\"collect_set(movieId) as movies\"))\n\ndisplay(perUserActual)","commandVersion":11,"state":"finished","results":{"type":"table","data":[[28,[12,19,82]],[27,[27,18,44]],[12,[27,31,17,91]],[22,[51,88,74]],[1,[68,62,77]],[13,[74,29]],[6,[63,43,61]],[3,[60,7]],[20,[77]],[5,[13,20,50,68,55]],[19,[90]],[15,[64,26]],[9,[30,70,32,90,7,14,95]],[17,[46,22,91]],[4,[52,41]],[8,[60,31,53]],[23,[27,13,49,10,73,65]],[7,[47]],[10,[42]],[25,[16,71]],[24,[63,72,59]],[29,[38,68,10]],[21,[96,59]],[11,[48,19,38,18,72]],[14,[53,72,76,14]],[2,[34,89]],[0,[9,2]],[18,[83,80]]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"integer\"","metadata":"{}"},{"name":"movies","type":"{\"type\":\"array\",\"elementType\":\"integer\",\"containsNull\":false}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"perUserActual","typeStr":"org.apache.spark.sql.DataFrame","schema":{"type":"struct","fields":[{"name":"userId","type":"integer","nullable":true,"metadata":{}},{"name":"movies","type":{"type":"array","elementType":"integer","containsNull":false},"nullable":false,"metadata":{}}]},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949555436,"submitTime":1653949436402,"finishTime":1653949560158,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"565","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",28]],"subcommandOptions":null,"nuid":"07933b7e-369d-491d-b587-344d9e8539ba"},{"version":"CommandV1","origId":2178463341864281,"guid":"8d75d4b5-ab8c-411f-a955-0a1e3854f43f","subtype":"command","commandType":"auto","position":8.5,"command":"// in Scala\nprintln(ranks.meanAveragePrecision)\nprintln(ranks.precisionAt(5))","commandVersion":15,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">0.27646876932591213\n0.55\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653949583845,"submitTime":1653949436466,"finishTime":1653949584853,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",52]],"subcommandOptions":null,"nuid":"5461ebcb-31c5-4534-beb1-2ef25b260131"},{"version":"CommandV1","origId":2542587478735838,"guid":"5d36dc54-2fc1-4203-ab20-64ee8e8abfb2","subtype":"command","commandType":"auto","position":6.625,"command":"%md\n## RMSE","commandVersion":5,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"nuid":"85a7a7ba-5c9e-42c3-8803-ba2bcb30da28"},{"version":"CommandV1","origId":2542587478735839,"guid":"cdb6d09a-35fd-4402-b7ec-066dd188b2d4","subtype":"command","commandType":"auto","position":6.875,"command":"%md \n## Regression Metrics","commandVersion":6,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"nuid":"855e3b71-ee53-48bc-8686-b409da5c29ff"},{"version":"CommandV1","origId":3196575877876781,"guid":"2ccbc08d-ca35-49a9-b90a-b31b73535e19","subtype":"command","commandType":"auto","position":2.5,"command":"ratings\n  .select(\"userId\")\n  .distinct\n  .orderBy(\"userId\")\n  .collect","commandVersion":29,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res20: Array[org.apache.spark.sql.Row] = Array([0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18], [19], [20], [21], [22], [23], [24], [25], [26], [27], [28], [29])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653950001259,"submitTime":1653950001243,"finishTime":1653950003367,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"768","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",244]],"subcommandOptions":null,"nuid":"d52edebf-cec6-498a-8a89-c564576c9230"},{"version":"CommandV1","origId":3196575877876782,"guid":"c8c821bd-5909-4466-9e24-ce186a5c98f8","subtype":"command","commandType":"auto","position":2.75,"command":"ratings\n  .select(\"movieId\")\n  .distinct\n  .orderBy(\"movieId\")\n  .collect","commandVersion":18,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">res21: Array[org.apache.spark.sql.Row] = Array([0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18], [19], [20], [21], [22], [23], [24], [25], [26], [27], [28], [29], [30], [31], [32], [33], [34], [35], [36], [37], [38], [39], [40], [41], [42], [43], [44], [45], [46], [47], [48], [49], [50], [51], [52], [53], [54], [55], [56], [57], [58], [59], [60], [61], [62], [63], [64], [65], [66], [67], [68], [69], [70], [71], [72], [73], [74], [75], [76], [77], [78], [79], [80], [81], [82], [83], [84], [85], [86], [87], [88], [89], [90], [91], [92], [93], [94], [95], [96], [97], [98], [99])\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653950042763,"submitTime":1653950042748,"finishTime":1653950044190,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"270","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",664]],"subcommandOptions":null,"nuid":"cc562c92-b876-4e96-86e2-f113f1cb44da"},{"version":"CommandV1","origId":3196575877876783,"guid":"21265075-2ab0-428d-b7e6-2d93172be6ea","subtype":"command","commandType":"auto","position":2.875,"command":"display(ratings\n  .where($\"userId\" === 0)\n  .orderBy(\"movieId\", \"timestamp\")\n)","commandVersion":54,"state":"finished","results":{"type":"table","data":[[0,2,3.0,1424380312],[0,3,1.0,1424380312],[0,5,2.0,1424380312],[0,9,4.0,1424380312],[0,11,1.0,1424380312],[0,12,2.0,1424380312],[0,15,1.0,1424380312],[0,17,1.0,1424380312],[0,19,1.0,1424380312],[0,21,1.0,1424380312],[0,23,1.0,1424380312],[0,26,3.0,1424380312],[0,27,1.0,1424380312],[0,28,1.0,1424380312],[0,29,1.0,1424380312],[0,30,1.0,1424380312],[0,31,1.0,1424380312],[0,34,1.0,1424380312],[0,37,1.0,1424380312],[0,41,2.0,1424380312],[0,44,1.0,1424380312],[0,45,2.0,1424380312],[0,46,1.0,1424380312],[0,47,1.0,1424380312],[0,48,1.0,1424380312],[0,50,1.0,1424380312],[0,51,1.0,1424380312],[0,54,1.0,1424380312],[0,55,1.0,1424380312],[0,59,2.0,1424380312],[0,61,2.0,1424380312],[0,64,1.0,1424380312],[0,67,1.0,1424380312],[0,68,1.0,1424380312],[0,69,1.0,1424380312],[0,71,1.0,1424380312],[0,72,1.0,1424380312],[0,77,2.0,1424380312],[0,79,1.0,1424380312],[0,83,1.0,1424380312],[0,87,1.0,1424380312],[0,89,2.0,1424380312],[0,91,3.0,1424380312],[0,92,4.0,1424380312],[0,94,1.0,1424380312],[0,95,2.0,1424380312],[0,96,1.0,1424380312],[0,98,1.0,1424380312],[0,99,1.0,1424380312]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"userId","type":"\"integer\"","metadata":"{}"},{"name":"movieId","type":"\"integer\"","metadata":"{}"},{"name":"rating","type":"\"float\"","metadata":"{}"},{"name":"timestamp","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1653950164370,"submitTime":1653950164357,"finishTime":1653950165413,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"503","height":"409.533","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",49]],"subcommandOptions":null,"nuid":"08f129ae-d23d-48d7-b2f2-17272d58c806"}],"dashboards":[],"guid":"c5fe48a3-115e-41ac-9053-b1fec26d9787","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}